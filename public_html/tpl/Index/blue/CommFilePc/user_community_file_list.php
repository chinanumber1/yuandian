<!DOCTYPE html><html lang="zh-CN" class="height_vh ng-scope"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css">@charset "UTF-8";[ng\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide{display:none !important;}ng\:form{display:block;}.ng-animate-block-transitions{transition:0s all!important;-webkit-transition:0s all!important;}.ng-hide-add-active,.ng-hide-remove{display:block!important;}</style>    <title>微信小程序电脑端</title>    <meta http-equiv="X-UA-Compatible" content="IE=edge"><!--    <meta name="keywords" content="OA,移动办公,移动OA,微信办公,手机办公oa,翼办公,移动办公,oa办公系统,OA软件,协同办公">--><!--    <meta name="description" content="oa.cn是中国领先的移动办公平台,为政府和企业提供OA软件系统,移动OA,微信办公,办公自动化系统,在线协同系统,支持Web,iPad,安卓和苹果手机客户端.工作就上oa.cn!">-->    <meta name="robots" content="all">    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">    <link href="{pigcms{$static_path}commfilepc/css/wechat.css?t=7" rel="stylesheet">    <link href="https://wx.oa.cn/t/res/default/wxaapp/img/fav.ico?version=1.0.0" rel="icon" type="image/x-icon">    <link rel="stylesheet" href="/tpl/System/Static/css/style.css">    <script type="text/javascript" src="{pigcms{$static_path}commfilepc/js/jquery-1.8.3.min.js"></script>    <script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.3.2.js"></script>    <script type="text/javascript" src="{pigcms{$static_path}commfilepc/js/layer.m.js"></script>    <style>        .btn { display: inline-block; padding: 6px 16px; margin-bottom: 0; font-size: 14px; font-weight: normal; line-height: 1.42857143; text-align: center; white-space: nowrap; vertical-align: middle; cursor: pointer; background-image: none; border: 1px solid transparent; border-radius: 4px; -ms-touch-action: manipulation; touch-action: manipulation; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; }        .btn-green {            background: #00b88a;            border-color: #00b88a;            color: #fff;        }        .textcenter {            text-align: center;        }        .pagebar .total {            margin-right: 15px;            height: 20px;            line-height: 20px;            display: inline-block;            _display: inline;        }        .clearfix {overflow: auto;zoom: 1;}        .content{width: 100%;height: 100%;margin: 0 auto;}        .file_upload{width: 100%;padding: 10px;position: relative;display: inline-block;vertical-align: top;box-sizing: border-box;}        .file_upload > div{width: 100%;height: 100%;}        .file_con .hide{width: 120px;height: 40px;opacity: 0;filter: alpha(opacity=0);position: absolute;top: 60%;left: 50%;transform: translate(-50%, -50%);z-index: 22;}        .file_con .file_uploader{position: absolute;top: 60%;left: 50%;transform: translate(-50%, -50%);display: inline-block;color: #fff;background: #16b990;            text-align: center;z-index: 11;border-radius: 5px;cursor: pointer;width: 120px;height: 40px;line-height: 40px;text-align: center;}        .file_con .hide:hover{box-shadow: 1px 2px #44795b;}        .input_wrapper{width: 100%;height: 185px;background: #e5f5f3;position: relative;font-size:14px;}        .input_wrapper .desc{padding:10px 10px 0;text-align: left;color: #666;}        .input_wrapper .type_accept{padding:0 10px 10px;text-align: left;color: #666;font-size:12px;}        .modal-submit-footer #uploadBtn{background: #16b990;display: none;line-height: 1rem;}        .modal-submit-footer #cancelBtn{background: #a80000;display: none;line-height: 1rem;}        .file_list{padding: 10px;display: none}        .file_list .item{width:100%;border:1px solid #ddd;box-sizing: border-box;position: relative;}        .file_list .item .image{float: left;width: 80px;padding: 10px 5px 5px;box-sizing: border-box}        .file_list .item .image img{width: 100%;}        .file_list .item .name_box{float: left;width: calc(100% - 90px)}        .file_list .item .delete{position: absolute;top: 0;right: 0;background: #838383;color: #ffffff;width: 20px;height: 20px;line-height: 20px;text-align: center;display: none;}        .file_list .item .name{padding: 20px 5px 10px;width: 100%;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;box-sizing: border-box;}        .file_list .item .size{padding: 0 5px;}        .progress_box{padding: 10px;color: #333333;display: none;}        .progress_box .delete{float: right;color: #16b990;display: none;}        .progress_box progress{color: #16b990;border: 1px solid #ddd;background-color:#f1f1f1;}        .progress_box progress::-moz-progress-bar { background: #f1f1f1; }        .progress_box progress::-webkit-progress-bar { background: #f1f1f1; }        .progress_box progress::-webkit-progress-value  { background: #16b990; }    </style></head><body class="min_width1000 ng-scope" id="oabody" ng-controller="oaIndexCtrl" bindonce="" style="background-color: #eef3f7;"><div class="home-header fixed" id="header_bg">    <div class="home-inner">        <div class="home-logo-wrp fl">            <span class="home-logo home-logo-default" id="header_logo"></span>        </div>    </div></div><div ng-controller="WebWxScanIndexCtrl" class="ng-scope">    <div class="home-page">        <div class="home-header fixed" id="header_bg">            <div class="home-inner">                <div class="home-logo-wrp fl">                    <span class="home-logo home-logo-default" id="header_logo"></span>                </div>            </div>        </div>        <div class="screen_one" id="screen_one">            <div class="figure relative" style="transform: rotateY(0.5turn); transform-style: preserve-3d; transition: transform 1s;">                <div id="wxscan_add">                    <div class="wechat_PC_wrap  new_bulit_cooperation text-center kanban-box ng-scope" ng-controller="WebWxScangroupfileCtrl" style="transform: rotateY(0.5turn) translateZ(1px); transition: opacity 1s 0.5s; opacity: 1;">                        <div><!--id="screen_one"-->                            <div class="home-page">                                <div class="wechat_PC_wrap text-center groupfiles-box" style="margin-top:-24px">                                    <div class="wechat_header clearfix">                                        <h3 class="wechat_title"><img src="{pigcms{$static_path}commfilepc/images/wechat_icon.png" alt="" class="wechat_icon">微信小程序电脑端</h3>                                        <div class="wechat_header_r">                                            <div class="wechat_header_r_imgwrap"><img src="{pigcms{$user.avatar}" alt="" onclick="isLogout()" style="cursor: pointer;"></div>                                            <!-- <p class="wechat_header_r_name">刘德华</p> -->                                        </div>                                    </div>                                    <div class="new_bulit_cooperation_main groupfile-box">                                        <!-- 下拉 -->                                        <div class="groupfile-cat" style="padding:5px 0px "><!-- caret -->                                            <div class="dropdown dropdown-inline" style="width:282px">                                                <span>当前群组：</span>                                                <form id="change_form" action="{pigcms{:U('CommFilePc/user_community_file_list')}" method="get" style="display: inline">                                                    <input type="hidden" name="c" value="CommFilePc"/>                                                    <input type="hidden" name="a" value="user_community_file_list"/>                                                    <if condition="$community_join_info['list']">                                                        <select style="cursor: pointer;width:150px;height: 28px" class="ng-pristine ng-valid select_comm" name="community_id">                                                            <volist name="community_join_info['list']" id="vo">                                                                <option value="{pigcms{$vo['community_id']}" <if condition="$community_id eq $vo['community_id']">selected="selected"</if>>{pigcms{$vo.community_name}</option>                                                            </volist>                                                        </select>&nbsp;&nbsp;                                                        <else/>&nbsp;                                                        <div>您暂未加入和创建任何群</div>                                                    </if>                                                </form>                                                <a href="{pigcms{$config['site_url']}/index.php?c=CommFilePc&a=redirect" title="刷新" ng-click="operation(&#39;&#39;, 0)" style="margin-left: 10px">                                                    <div style="display: inline-block; vertical-align: middle;"><img src="{pigcms{$static_path}commfilepc/images/freshen.png" alt=""></div>                                                </a>                                            </div><!--  -->                                        </div>                                        <!-- 下拉 -->                                        <!-- 表头 -->                                        <div class="groupfile-hd">                                            <ul class="groupfile-hd-ul clearfix">                                                <li class="left-item" onclick="file_list()" style="cursor: pointer;" ng-show="folderid==0"><a>群文件</a></li>                                                <if condition="$is_file">                                                    <li  onclick="file_list('{pigcms{$community_file.folder_id}')" style="cursor: pointer;" class="ng-scope"><a style="color: #2e5aac" class="ng-binding">&gt;{pigcms{$community_file['folder_name']}-{pigcms{$community_id}</a></li>                                                </if>                                                <li class="right-item">                                                    <if condition="$community_folder['is_add_folder']">                                                        <span class="mright20 groupfile-folder" title="新建文件夹" onclick="addFolderTip('{pigcms{$community_id}')" style="cursor: pointer;"></span>                                                    </if>                                                    <if condition="$is_file && $community_file['is_upload']">                                                        <button class="btn btn-green groupfile-upload" title="上传文件" onclick="upload('{pigcms{$community_file.folder_id}')">上传</button>                                                    </if>                                                </li>                                            </ul>                                        </div>                                        <!-- 表头 -->                                        <!-- 表主体 -->                                        <div class="groupfile-bd">                                            <table class="table-groupfile">                                                <thead>                                                <tr><th>                                                    </th><td style="width:55%;padding-left:20px;">名称</td>                                                    <td style="width:15%;">上传时间</td>                                                    <td style="width:15%;">上传者</td>                                                    <td style="width:15%;">大小</td>                                                </tr></thead>                                            </table>                                            <div class="groupfile-bd-box kscroll-box" style="overflow-y: auto;min-height: 350px;">                                                <table class="table table-groupfile-body">                                                    <tbody>                                                    <if condition="$community_folder['list']">                                                        <volist name="community_folder['list']" id="vo">                                                            <tr style="border-top: 0px solid #ddd;" class="ng-scope">                                                                <td class="td1" style="width:57%">                                                                    <div class="groupfile-td">                                                                        <!--显示图片类型-->                                                                        <span class="icon-groupfile fold-file" onclick="file_list('{pigcms{$vo.folder_id}')"></span>                                                                        <a class="title textover ng-binding" style="width: 180px;cursor: pointer;" onclick="file_list('{pigcms{$vo.folder_id}')" title="{pigcms{$vo['folder_name']}">{pigcms{$vo.folder_name}</a>                                                                            <!--操作类型-->                                                                        <div class="groupfile-act" style="right: 2px;top: 10px;">                                                                            <!--                                                                    <a href="" class="mleft12" title="详情">-->                                                                            <!--                                                                    <span class="groupfile-code" ng-mouseenter="showCode(item.id,$event)" ng-mouseleave="hideCode()">-->                                                                            <!--                                                                        <div class="groupfile-code-div" style="display: none;"> //ng-mouseover="" ng-mouseleave = ""  ng-click-->                                                                            <!--                                                                            <img class="groupfile-code-div-img" style="" src="https://wx.oa.cn/userfiles/weapp/2006/qrcode/201807/20/_5b5174729a2f5.png">-->                                                                            <!--                                                                            <span>微信扫码可转发</span>-->                                                                            <!--                                                                        </div>-->                                                                            <!--                                                                    </span>-->                                                                            <!---->                                                                            <!--                                                                    </a>-->                                                                            <if condition="$vo['is_edit']">                                                                                <a class="mleft12" title="修改"  onclick="updateFolderTip('{pigcms{$vo.folder_id}' ,'{pigcms{$vo.folder_name}', '{pigcms{$vo.other_is_upload}')">                                                                                    <span class="groupfile-mod"></span>                                                                                </a>                                                                            </if>                                                                            <if condition="$vo['is_del']">                                                                                <a class="mleft12" title="删除" onclick="delFolderTip('{pigcms{$vo.folder_id}' ,'{pigcms{$vo.folder_name}')">                                                                                    <span class="groupfile-del"></span>                                                                                </a>                                                                            </if>                                                                        </div>                                                                    </div>                                                                </td>                                                                <td style="width:15%;padding:0px;" class="ng-binding">{pigcms{$vo.add_time|date='Y-m-d H:i:s',###}</td>                                                                <td style="width:15%;padding-left:8px;" class="ng-binding">{pigcms{$vo.nickname}</td>                                                            </tr>                                                        </volist>                                                        <tr style="display: table-row;vertical-align: inherit;"><td style="display: table-cell;vertical-align: inherit;" class="textcenter pagebar" colspan="9">{pigcms{$page_info}</td></tr>                                                        <elseif condition="$community_file['list']"/>                                                        <volist name="community_file['list']" id="vo">                                                            <tr style="border-top: 0px solid #ddd;" class="ng-scope">                                                                <td class="td1" style="width:57%">                                                                    <div class="groupfile-td">                                                                        <!--显示图片类型-->                                                                        <span class="icon-groupfile fold-file" style="background: url('{pigcms{$vo["file_img"]["url"]}') no-repeat;background-size: cover;"></span>                                                                        <a href="{pigcms{$vo.file_url}" class="title textover ng-binding" style="width: 180px;cursor: pointer;" title="{pigcms{$vo['file_remark']}">{pigcms{$vo.file_remark}</a>                                                                        <!--操作类型-->                                                                        <div class="groupfile-act" style="right: 2px;top: 10px;">                                                                            <a href="{pigcms{$vo.file_url}" class="mleft12" title="下载" download="proposed_file_name">                                                                                <span class="groupfile-down"></span>                                                                            </a>                                                                            <!--                                                                    <a href="" class="mleft12" title="详情">-->                                                                            <!--                                                                    <span class="groupfile-code" ng-mouseenter="showCode(item.id,$event)" ng-mouseleave="hideCode()">-->                                                                            <!--                                                                        <div class="groupfile-code-div" style="display: none;"> //ng-mouseover="" ng-mouseleave = ""  ng-click-->                                                                            <!--                                                                            <img class="groupfile-code-div-img" style="" src="https://wx.oa.cn/userfiles/weapp/2006/qrcode/201807/20/_5b5174729a2f5.png">-->                                                                            <!--                                                                            <span>微信扫码可转发</span>-->                                                                            <!--                                                                        </div>-->                                                                            <!--                                                                    </span>-->                                                                            <!---->                                                                            <!--                                                                    </a>-->                                                                            <if condition="$vo['is_del']">                                                                                <a class="mleft12" title="删除" onclick="delFileTip('{pigcms{$vo.file_id}' ,'{pigcms{$vo.file_remark}')">                                                                                    <span class="groupfile-del"></span>                                                                                </a>                                                                            </if>                                                                        </div>                                                                    </div>                                                                </td>                                                                <td style="width:15%;padding:0px;" class="ng-binding">{pigcms{$vo.add_time|date='Y-m-d H:i:s',###}</td>                                                                <td style="width:15%;padding-left:8px;" class="ng-binding">{pigcms{$vo.file_nickname}</td>                                                                <td style="width:15%;padding-left:5px;">                                                                    <span class="groupfile-size ng-binding">                                                                        <if condition="$vo['size']">                                                                        {pigcms{$vo.size}B                                                                        </if>                                                                    </span>                                                                </td>                                                            </tr>                                                        </volist>                                                        <tr style="display: table-row;vertical-align: inherit;"><td style="display: table-cell;vertical-align: inherit;" class="textcenter pagebar" colspan="9">{pigcms{$page_info}</td></tr>                                                        <else/>                                                        <div class="blank-tips" ng-show="filelist == 0"><div class="blank-img"></div><div class="blank-txt">空空如也</div></div>                                                    </if>                                                    </tbody>                                                </table>                                            </div>                                        </div>                                        <!-- 表主体 -->                                        <!-- 表底 -->                                        <div class="groupfile-ft clearfix">                                            <div class="ft-txt">仅限上传50MB以内的MP3、MP4、WMV、EXCEL、TEXT、PPT、PDF、WORD、CHM、压缩包、手机安装包和图片。</div>                                        </div>                                        <!-- 表底 -->                                    </div>                                </div>                            </div>                        </div>                    </div>                    <script type="text/ng-template" id="_tooltip_NoReplyTpl" class="ng-scope">                        <div class="coop_tooltip popover fade top in {{bgClass}}" role="tooltip" style="position: fixed;">                            <span ng-bind-html="content|to_trusted"></span>                        </div>                    </script>                </div>            </div>        </div>    </div>    <div class="modal-submit tleft ng-hide" ng-show="grouptip" style="padding:0px;width: 480px">        <div style="padding: 20px;border-bottom: 1px solid #e5e5e5;">            <h2 style="margin-bottom:0px">提示：</h2>        </div>        <div style="padding: 30px 60px 30px 60px;">            <p>由于无法获取微信群名称，故显示“未命名微信群”，建议您在小程序端打开群空间，并在底部点击“设置-群名称”设置群名。            </p>        </div>        <div class="modal-submit-footer tcenter" style="padding: 15px 0px;border-top: 1px solid #e5e5e5;margin-top: 0px;">            <a href="javascript:void(0);" class="log_down" ng-click="close()">取消</a>            <button class="btn btn-green" ng-click="close()">确定</button>        </div>    </div>    <!--点击获取群文件列表-->    <div class="modal-submit tleft ng-hide" id="get_file" style="padding:0px;width: 480px">        <form id="form_file_list" action="{pigcms{:U('CommFilePc/user_community_file_list')}" method="get" style="display: inline">            <input type="hidden" name="c" value="CommFilePc"/>            <input type="hidden" name="a" value="user_community_file_list"/>            <input type="hidden" name="community_id" value="{pigcms{$community_id}"/>            <input type="hidden" id="get_folder_id" name="folder_id" value=""/>            <div class="modal-submit-footer tcenter" style="padding: 15px 0px;border-top: 1px solid #e5e5e5;margin-top: 0px;">                <button class="btn btn-green">确定</button>            </div>        </form>    </div>    <!--删除文件夹、文件提示-->    <div class="modal-submit tleft ng-hide" id="delFolderTip" style="padding:0px;width: 480px">        <form id="form_del_folder" action="{pigcms{:U('CommFilePc/del_folder')}" method="post" style="display: inline">            <input type="hidden" name="c" value="CommFilePc"/>            <input type="hidden" name="a" value="del_folder"/>            <input type="hidden" name="folder_id" id="del_folder_id" value=""/>            <div style="padding: 20px;border-bottom: 1px solid #e5e5e5;">                <h2 style="margin-bottom:0px">警告：</h2>            </div>            <div style="padding: 30px 60px 30px 60px;" id="del_floder" class="">                <p class="ng-binding">确定删除""文件夹？文件夹中的文件也将会一并被删除，且无法恢复！</p>            </div>            <div class="modal-submit-footer tcenter" style="padding: 15px 0px;border-top: 1px solid #e5e5e5;margin-top: 0px;">                <a href="javascript:void(0);" class="log_down" onclick="delClose()">取消</a>                <button class="btn btn-green">确定</button>            </div>        </form>    </div>    <!--删除文件、文件提示-->    <div class="modal-submit tleft ng-hide" id="delFileTip" style="padding:0px;width: 480px">        <form id="form_del_file" action="{pigcms{:U('CommFilePc/del_file')}" method="post" style="display: inline">            <input type="hidden" name="c" value="CommFilePc"/>            <input type="hidden" name="a" value="del_file"/>            <input type="hidden" name="file_id" id="del_fole_id" value=""/>            <div style="padding: 20px;border-bottom: 1px solid #e5e5e5;">                <h2 style="margin-bottom:0px">警告：</h2>            </div>            <div style="padding: 30px 60px 30px 60px;" id="del_file">                <p class="ng-binding">确定删除""？删除之后将无法恢复！</p>            </div>            <div class="modal-submit-footer tcenter" style="padding: 15px 0px;border-top: 1px solid #e5e5e5;margin-top: 0px;">                <a href="javascript:void(0);" class="log_down" onclick="delFileClose()">取消</a>                <button class="btn btn-green">确定</button>            </div>        </form>    </div>    <!--编辑文件夹-->    <div class="modal-submit tleft ng-hide" id="updateflodertip" style="padding:0px;width: 480px">        <form id="form_add_folder" action="{pigcms{:U('CommFilePc/edit_folder')}" method="post" style="display: inline">            <input type="hidden" name="c" value="CommFilePc"/>            <input type="hidden" name="a" value="edit_folder"/>            <input type="hidden" name="folder_id" id="update_folder_id" value=""/>            <div style="padding: 20px;border-bottom: 1px solid #e5e5e5;">                <h2 style="margin-bottom:0px">编辑文件夹</h2>            </div>            <div style="padding: 30px 60px 30px 60px;">                <input class="form-control ng-pristine ng-valid" maxlength="100" name="folder_name" style="width: 100%;" id="update_folder_name">            </div>            <div style="padding: 0px 20px 10px;">                <h5 style="margin-bottom:0px">是否允许其他人上传文件:</h5>            </div>            <div style="padding: 0px 60px 50px 60px;" class="upload_floder">                <span class="cb-enable"><label class="cb-enable selected"><span>开启</span><input name="other_is_upload" type="radio" value="2" checked="checked"/></label></span>                <span class="cb-disable"><label class="cb-disable"><span>关闭</span><input name="other_is_upload" type="radio" value="1"/></label></span>            </div>            <div class="modal-submit-footer tcenter" style="padding: 15px 0px;border-top: 1px solid #e5e5e5;margin-top: 0px;">                <a href="javascript:void(0);" class="log_down" onclick="updateFolderClose()">取消</a>                <button class="btn btn-green">确定</button>            </div>        </form>    </div>    <!--添加文件夹-->    <div class="modal-submit tleft ng-hide" id="addfoldertip" style="padding:0px;width: 480px">        <form id="form_add_folder" action="{pigcms{:U('CommFilePc/add_folder')}" method="post" style="display: inline">            <input type="hidden" name="c" value="CommFilePc"/>            <input type="hidden" name="a" value="add_folder"/>            <input type="hidden" name="community_id" value="{pigcms{$community_id}"/>            <div style="padding: 20px;border-bottom: 1px solid #e5e5e5;">                <h2 style="margin-bottom:0px">输入文件夹名称</h2>            </div>            <div style="padding: 30px 60px 30px 60px;">                <input class="form-control ng-pristine ng-valid" maxlength="100" name="folder_name" style="width: 100%;" id="folder_name" autofocus="autofocus">            </div>            <div style="padding: 0px 20px 10px;">                <h5 style="margin-bottom:0px">是否允许其他人上传文件:</h5>            </div>            <div style="padding: 0px 60px 50px 60px;">                <span class="cb-enable"><label class="cb-enable selected"><span>开启</span><input name="other_is_upload" type="radio" value="2" checked="checked"/></label></span>                <span class="cb-disable"><label class="cb-disable"><span>关闭</span><input name="other_is_upload" type="radio" value="1"/></label></span>            </div>            <div class="modal-submit-footer tcenter" style="padding: 15px 0px;border-top: 1px solid #e5e5e5;margin-top: 0px;">                <a href="javascript:void(0);" class="log_down" onclick="folderClose()">取消</a>                <button class="btn btn-green" onclick="addFolder()">确定</button>            </div>        </form>    </div>    <!--退出登录-->    <div class="modal-submit tleft ng-hide" id="logoutUser" style="padding:0px;width: 480px">        <form action="{pigcms{:U('CommFilePc/logout')}" method="post" style="display: inline">            <input type="hidden" name="c" value="CommFilePc"/>            <input type="hidden" name="a" value="logout"/>            <div style="padding: 20px;border-bottom: 1px solid #e5e5e5;">                <h2 style="margin-bottom:0px">退出</h2>            </div>            <div style="padding: 30px 60px 30px 60px;">                <span>是否确认退出</span>            </div>            <div class="modal-submit-footer tcenter" style="padding: 15px 0px;border-top: 1px solid #e5e5e5;margin-top: 0px;">                <a href="javascript:void(0);" class="log_down" onclick="logoutClose()">取消</a>                <button class="btn btn-green">确定</button>            </div>        </form>    </div>    <!--上传文件夹-->    <div class="modal-submit tleft ng-hide" id="post_file_form_info" style="padding:0px;width: 480px">        <input type="hidden" name="c" value="CommFilePc"/>        <input type="hidden" name="a" value="add_file"/>        <input type="hidden" name="folder_id" id="post_folder_id" value=""/>        <input type="hidden" name="community_id" value="{pigcms{$community_id}"/>        <div class="file_upload">            <div class="file_con">                <div class="input_wrapper" >                    <div class="desc">请选择需要上传的文件，大小不超过50M，类型支持：MP3、MP4、WMV、EXCEL、TEXT、PPT、PDF、WORD、CHM、压缩包、手机安装包和图片</div>                    <!--<div class="type_accept">MP3、MP4、WMV、EXCEL、TEXT、PPT、PDF、WORD、CHM、压缩包、手机安装包和图片</div>-->                    <input id="file" name="file" type="file" class="hide" ><span class="file_uploader">选择文件</span>                </div>            </div>        </div>        <div class="file_list">            <div class="item clearfix">                <div class="image"><img src="https://hf.pigcms.com/static/wxapp/file.png" /></div>                <div class="name_box"></div>            </div>        </div>        <div class="progress_box">            上传进度：<progress value="0" max="0"></progress>            <text id="progress">0%</text>            <text class="delete">删除</text>        </div><!--        <div class="btn_box">--><!--            <button id="uploadBtn">开始上传</button>--><!--            <button id="cancelBtn">取消上传</button>--><!--        </div>-->        <div class="modal-submit-footer tcenter" style="padding: 15px 0px;border-top: 1px solid #e5e5e5;margin-top: 0px;">            <button class="btn btn-green" id="uploadBtn">开始上传</button>            <button class="btn" id="cancelBtn">取消上传</button>            <a href="javascript:void(0);" class="log_down" style="margin-left: 2rem;" onclick="delPostClose()">取消</a>        </div>    </div></div><script>    var winWidth = 0;    var winHeight = 0;    function findDimensions() //函数：获取尺寸    {//获取窗口宽度        if (window.innerWidth)            winWidth = window.innerWidth;        else if ((document.body) && (document.body.clientWidth))            winWidth = document.body.clientWidth;//获取窗口高度        if (window.innerHeight)            winHeight = window.innerHeight;        else if ((document.body) && (document.body.clientHeight))            winHeight = document.body.clientHeight;//通过深入Document内部对body进行检测，获取窗口大小        if (document.documentElement && document.documentElement.clientHeight && document.documentElement.clientWidth) {            winHeight = document.documentElement.clientHeight;            winWidth = document.documentElement.clientWidth;        }        console.log('宽度---------------' + winWidth);        console.log('高度---------------' + winHeight);        var width = 0.6 * winWidth;        var height = 0.8 * winHeight;        var margin_left = - (0.3 * winWidth);        if (width < 770) {            width = 770;        }        if (width < 770) {            width = 770;        }        if (height < 580) {            height = 580;        }        $('.groupfiles-box').css({'width': width + 'px', 'height': height + 'px', 'margin-left': margin_left + 'px'});        var groupfile_height = 0.7 * height;        $('.groupfile-bd').css({'height': groupfile_height + 'px'});        var groupfile_bd_box_height = 0.5 * height;        $('.groupfile-bd-box .kscroll-box').css({'height': groupfile_bd_box_height + 'px', 'overflow-y': 'auto'});    }    findDimensions();    // 登出    function isLogout() {        $("#logoutUser").removeClass('ng-hide');    }    // 取消登出    function logoutClose() {        $("#logoutUser").addClass('ng-hide');    }    // 开关    $('.cb-enable').click(function () {        console.log('切换状态-', $(this))        console.log('切换状态-change_info->cb-enable')        $(this).find('label').addClass('selected');        $(this).find('label').find('input').prop('checked', true);        $(this).next('.cb-disable').find('label').find('input').prop('checked', false);        $(this).next('.cb-disable').find('label').removeClass('selected');    });    $('.cb-disable').click(function () {        console.log('切换状态-change_info->cb-disable')        $(this).find('label').addClass('selected');        $(this).find('label').find('input').prop('checked', true);        $(this).prev('.cb-enable').find('label').find('input').prop('checked', false);        $(this).prev('.cb-enable').find('label').removeClass('selected');    });    // 切换群选项    $(".select_comm").change(function(){        var community_id = $(".select_comm").val();        console.log('改变了值', community_id);        $('#change_form').submit();    });    // 获取对应的群文件夹信息    function file_list(folder_id) {        console.log('获取对应的群文件夹信息');        if (folder_id) {            $('#get_folder_id').val(folder_id);        }        $('#form_file_list').submit();    }    // 添加群文件夹    function addFolderTip(community_id) {        console.log('添加用户文件夹', community_id)        $("#addfoldertip").removeClass('ng-hide');    }    // 取消添加群文件夹    function folderClose() {        $("#addfoldertip").addClass('ng-hide');    }    // 确认添加群文件夹    function addFolder(community_id) {        console.log('添加用户文件夹', community_id)        $("#form_add_folder").submit();    }    // 编辑群文件夹名称    function updateFolderTip(folder_id, folder_name, other_is_upload) {        console.log('群文件夹id:    ', folder_id)        console.log('群文件名称:   ', folder_name)        console.log('其他人是否可以在文件中上传文件    :', other_is_upload)        $("#updateflodertip").removeClass('ng-hide');        $("#update_folder_id").val(folder_id);        $("#update_folder_name").val(folder_name);        if (other_is_upload == 2) {            $(".upload_floder .cb-enable").find('label').addClass('selected');            $(".upload_floder .cb-enable").find('label').find('input').prop('checked', true);            $(".upload_floder .cb-enable").next('.cb-disable').find('label').find('input').prop('checked', false);            $(".upload_floder .cb-enable").next('.cb-disable').find('label').removeClass('selected');        } else {            $('.upload_floder .cb-disable').find('label').addClass('selected');            $('.upload_floder .cb-disable').find('label').find('input').prop('checked', true);            $('.upload_floder .cb-disable').prev('.cb-enable').find('label').find('input').prop('checked', false);            $('.upload_floder .cb-disable').prev('.cb-enable').find('label').removeClass('selected');        }    }    // 取消编辑    function updateFolderClose() {        $("#updateflodertip").addClass('ng-hide');    }    // 删除文件夹    function delFolderTip(folder_id, folder_name) {        console.log('群文件夹id:    ', folder_id)        console.log('群文件名称:   ', folder_name)        $('#delFolderTip').removeClass('ng-hide');        $('#del_floder .ng-binding').html('确定删除【'+ folder_name +'】文件夹？文件夹中的文件也将会一并被删除，且无法恢复！');        $('#del_folder_id').val(folder_id);    }    // 删除文件夹    function delFileTip(fole_id, fole_name) {        console.log('群文件id:    ', fole_id)        console.log('群文名称:   ', fole_name)        $('#delFileTip').removeClass('ng-hide');        $('#del_file .ng-binding').html('确定删除【'+ fole_name +'】文件？删除之后将无法恢复');        $('#del_fole_id').val(fole_id);    }    // 取消删除    function delClose() {        $('#delFileTip').addClass('ng-hide');    }    // 文件上传    function upload(folder_id) {        console.log('群文件夹id:    ', folder_id)       $('#post_file_form_info').removeClass('ng-hide');       $('#post_folder_id').val(folder_id)    }    // 取消文件上传    function delPostClose() {        $('#post_file_form_info').addClass('ng-hide');    }    // var urlParam = GetRequest();    var url = "{pigcms{$config['site_url']}/index.php?c=CommFilePc&a=add_file"    var file = '';    var request = '';    var percent = 0;    // 文件上传    $('#uploadBtn').on('click', function () {        if (percent > 0 && percent<100) {            layer.open({                content: '当前文件还未上传完毕，请勿重复点击！',                btn: ['确定'],                shadeClose: false            });            return        }        if (file.size > 1024*1024*50) {            layer.open({                content: '文件大小不得超过50M，请重新选择符合条件的文件！',                btn: ['确定'],                shadeClose: false            });            $('.file_list').hide();            $('.progress_box').hide();            $('.file_list .name_box').children().remove();            file = '';            return        }        if (file) {            var folder_id = $('#post_folder_id').val();            $('#file').hide();            $('.delete').hide();            $('#uploadBtn').hide();            $('#cancelBtn').show();            var formData = new FormData();            formData.append('file',  file);            formData.append('folder_id',  folder_id);            formData.append('community_id',  '{pigcms{$community_id}');            request = $.ajax({                url: url ,                type: 'POST',                data: formData,                xhr: function(){ //获取ajaxSettings中的xhr对象，为它的upload属性绑定progress事件的处理函数                    myXhr = $.ajaxSettings.xhr();                    if(myXhr.upload){ //检查upload属性是否存在                        //绑定progress事件的回调函数                        myXhr.upload.addEventListener('progress',progressHandlingFunction, false);                    }                    return myXhr; //xhr对象返回给jQuery使用                },                contentType: false,                processData: false,                success: function (data) {                    if (request != '') {                        if (data.status > 0) {                            layer.open({                                content: data.msg,                                btn: ['确定'],                                shadeClose: false,                                yes: function (index) {                                    if (data.status == 2) {                                        window.location.href = data.jump_url;                                    }                                }                            });                        } else {                            wx.miniProgram.navigateBack({                                delta: 1                            });                            layer.open({                                content: '上传成功！',                                btn: ['确定'],                                shadeClose: false,                                yes: function (index) {                                    window.location.href = window.location.href;                                }                            });                        }                    }                },                error: function (data) {                    if (request != '' && data.status > 0) {                        layer.open({                            content: data.msg,                            btn: ['确定'],                            shadeClose: false                        });                    }                }            });        } else {            layer.open({                content: '您还未选择文件！',                btn: ['确定'],                shadeClose: false            });        }    });    $('#cancelBtn').on('click', function () {        request.abort();        request = '';        percent = 0;        $('progress').attr({value : 0, max : 0}); //更新数据到进度条        $('#progress').html('0%');        $(this).hide();        $('#file').show();        $('.delete').show();        $('#uploadBtn').show()    });    //上传进度回调函数：    function progressHandlingFunction(e) {        if (e.lengthComputable) {            $('progress').attr({value : e.loaded, max : e.total}); //更新数据到进度条            percent = e.loaded/e.total*100;            // $('#progress').html(e.loaded + "/" + e.total+" bytes. " + percent.toFixed(2) + "%");            $('#progress').html(percent.toFixed(2) + "%");        }    }    $(document).on('change', '#file', function () {        $('.file_list .name_box').children().remove();        file = $("#file")[0].files[0];        if (file) {            $('.file_list').show();            $('.progress_box').show();            $('.delete').show();            $('#uploadBtn').show();            $('#cancelBtn').hide();            $('.btn_box').show();            $('progress').attr({value : 0, max : 0}); //更新数据到进度条            $('#progress').html('0%');            var fileSize = 0;            if (file.size > 1024 * 1024){                fileSize = (Math.round(file.size * 100 / (1024 * 1024)) / 100).toString() + 'MB';            }else{                fileSize = (Math.round(file.size * 100 / 1024) / 100).toString() + 'KB';            }            var itemHtml = '<div class="name">'+ file.name +'</div>\n' + '<div class="size">'+ fileSize +'</div>\n'            $('.name_box').append(itemHtml)        }    })    $(document).on('click', '.delete', function(){        $('.file_list').hide();        $(this).parent().hide();        $('.btn_box').hide();        $('#file').val('');        file = ''    });    $('.file_uploader').click(function () {        console.log('群文名称111:   ')        if (percent > 0 && percent< 100) {            layer.open({                content: '当前文件还未上传完毕，请稍后再选择其它文件',                btn: ['确定'],                shadeClose: false            });        } else {            $('#file').click()        }    })</script></body></html>